{"version":3,"names":[],"mappings":"","sources":["app.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\n\n$(document).ready(function () {\n\n    moment.locale('en', {\n        relativeTime: {\n            future: \"in %s\",\n            past: \"%s ago\",\n            s: \"%d seconds\",\n            m: \"a minute\",\n            mm: \"%d minutes\",\n            h: \"an hour\",\n            hh: \"%d hours\",\n            d: \"a day\",\n            dd: \"%d days\",\n            M: \"a month\",\n            MM: \"%d months\",\n            y: \"a year\",\n            yy: \"%d years\"\n        }\n    });\n\n    var serverOffset = moment($('meta[name=server-time]').attr('content')).diff(new Date()) + 1000;\n\n    var pusher = new Pusher($('meta[name=pusher-key]').attr('content'));\n    var channel = pusher.subscribe($('meta[name=pusher-channel]').attr('content'));\n\n    channel.bind('DeviceWasDeleted', function (data) {\n        $('#device-' + data.device.id).remove();\n\n        if (!$('.device-row').length) {\n            $('.js-no-devices').removeClass('hidden');\n            $('#device-table').addClass('hidden');\n        }\n    });\n\n    channel.bind('ServerWasPoked', function (data) {\n        var device = $('#device-' + data.device.id);\n\n        if (device.length) {\n            device.find('.device-name').text(data.device.name);\n            device.find('.device-ip').text(data.device.ip);\n            device.find('.device-updated_at').text(moment(data.device.updated_at).from(moment(data.device.server_time))).data('timestamp', data.device.updated_at);\n        } else {\n            var newRow = \"<tr class=\\\"device-row\\\" id=\\\"device-\" + data.device.id + \"\\\"> \\\n                    <td class=\\\"device-name\\\">\" + data.device.name + \"</td> \\\n                    <td class=\\\"device-ip\\\">\" + data.device.ip + \"</td> \\\n                    <td data-timestamp=\\\"\" + data.device.created_at + \"\\\" class=\\\"device-created_at\\\">\" + moment(data.device.created_at).subtract(serverOffset, 'milliseconds').fromNow() + \"</td> \\\n                    <td data-timestamp=\\\"\" + data.device.updated_at + \"\\\" class=\\\"device-updated_at\\\">\" + moment(data.device.updated_at).subtract(serverOffset, 'milliseconds').fromNow() + \"</td> \\\n                </tr>\";\n\n            $('#device-table tr:last').after(newRow);\n        }\n\n        if ($('.device-row').length) {\n            $('.js-no-devices').addClass('hidden');\n            $('#device-table').removeClass('hidden');\n        }\n    });\n\n    var updateTime = function updateTime() {\n        $('.device-updated_at').each(function () {\n            $(this).text(moment($(this).data('timestamp')).subtract(serverOffset, 'milliseconds').fromNow());\n        });\n    };\n\n    setInterval(updateTime, 1000);\n});\n\n},{}]},{},[1]);\n"],"file":"app.js","sourceRoot":"/source/"}